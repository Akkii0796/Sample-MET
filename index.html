<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <!-- jsPDF and AutoTable libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 10px; }
        .container { max-width: 1200px; margin: 0 auto; background: rgba(255,255,255,0.95); border-radius: 20px; backdrop-filter: blur(10px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; animation: slideUp 0.5s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px);} to { opacity: 1; transform: translateY(0);} }
        .header { background: linear-gradient(135deg, #4f46e5, #7c3aed); color: white; padding: 20px; text-align: center; }
        .header h1 { font-size: 2rem; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);}        
        .main-content { display: grid; grid-template-columns: 1fr; gap: 20px; padding: 20px; }
        @media (min-width: 768px) { .main-content { grid-template-columns: 1fr 1fr; }}
        @media (min-width: 1024px) { .main-content { grid-template-columns: 1fr 1fr 1fr; }}
        .card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.05); transition: all 0.3s ease; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(0,0,0,0.15);}        
        .card h2 { color: #4f46e5; margin-bottom: 15px; font-size: 1.3rem; display: flex; align-items: center; gap: 10px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; color: #374151; font-weight: 600; font-size: 0.9rem; }
        .input-group input, .input-group select, .input-group textarea { width: 100%; padding: 12px 15px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 1rem; transition: all 0.3s ease; background: #f9fafb; }
        .input-group input:focus, .input-group select:focus, .input-group textarea:focus { outline: none; border-color: #4f46e5; background: white; box-shadow: 0 0 0 3px rgba(79,70,229,0.1);}        
        .radio-group { display: flex; gap: 15px; margin-top: 5px; }
        .radio-option { display: flex; align-items: center; gap: 5px; }
        .radio-option input[type="radio"] { width: auto; margin: 0; }
        .radio-option label { margin: 0; font-weight: normal; cursor: pointer; }
        .btn { background: linear-gradient(135deg, #4f46e5, #7c3aed); color: white; border: none; padding: 12px 24px; border-radius: 10px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; width: 100%; margin-top: 10px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(79,70,229,0.3);}        
        .btn:active { transform: translateY(0);}        
        .btn-secondary { background: linear-gradient(135deg, #10b981, #059669);}        
        .btn-danger { background: linear-gradient(135deg, #ef4444, #dc2626); padding: 8px 16px; font-size: 0.9rem; width: auto; margin: 0; }
        .budget-summary { display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 15px; }
        @media (min-width: 480px) { .budget-summary { grid-template-columns: repeat(3,1fr); }}        
        .budget-item { text-align: center; padding: 15px; border-radius: 10px; background: linear-gradient(135deg, #f3f4f6,#e5e7eb); }
        .budget-item.budget { background: linear-gradient(135deg,#dbeafe,#bfdbfe);}        
        .budget-item.spent { background: linear-gradient(135deg,#fee2e2,#fecaca);}        
        .budget-item.remaining { background: linear-gradient(135deg,#d1fae5,#a7f3d0);}        
        .budget-item h3 { font-size: 0.9rem; color: #6b7280; margin-bottom: 5px;}        
        .budget-item .amount { font-size: 1.5rem; font-weight: bold; color: #1f2937;}        
        .table-container { overflow-x: auto; margin-top: 15px; border-radius: 10px; border: 1px solid #e5e7eb; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        th { background: linear-gradient(135deg,#4f46e5,#7c3aed); color: white; padding: 12px 8px; text-align: left; font-weight: 600; }
        td { padding: 12px 8px; border-bottom: 1px solid #e5e7eb; }
        tr:hover { background: #f9fafb; }
        .stats-grid { display: grid; grid-template-columns: 1fr; gap: 20px; grid-column: 1/-1; }
        @media (min-width: 768px) { .stats-grid { grid-template-columns: 1fr 1fr; }}        
        .icon { font-size: 1.2rem; }
        .full-width { grid-column: 1/-1; }
        .download-buttons { display: flex; gap: 10px; flex-wrap: wrap; }
        .download-buttons .btn { flex: 1; min-width: 120px; }
        @media (max-width: 480px) { .header h1 { font-size: 1.5rem;} .main-content { padding: 15px; gap: 15px;} .card { padding: 15px;} table { font-size: 0.8rem;} th, td { padding: 8px 4px;} }
        .expense-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #e5e7eb;}        
        .expense-item:last-child { border-bottom: none;}        
        .expense-details { flex-grow: 1;}        
        .expense-category { font-weight: 600; color: #4f46e5;}        
        .expense-vendor { color: #6b7280; font-size: 0.9rem;}        
        .expense-amount { font-weight: bold; color: #1f2937; margin-right: 10px;}        
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite;}        
        @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
        .sync-status { padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9rem; text-align: center; }
        .sync-success { background: #d1fae5; color: #065f46; border: 1px solid #10b981; }
        .sync-error { background: #fee2e2; color: #991b1b; border: 1px solid #ef4444; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Expense Tracker - <span id="currentMonth"></span></h1>
            <p>Track your expenses and manage your budget efficiently</p>
        </div>
        <div class="main-content">
            <!-- Budget Section -->
            <div class="card">
                <h2>üéØ Set Monthly Budget</h2>
                <div id="syncStatus" class="sync-status" style="display:none;"></div>
                <div class="input-group">
                    <label for="budgetAmount">Budget Amount (‚Çπ)</label>
                    <input type="number" id="budgetAmount" placeholder="Enter your monthly budget">
                </div>
                <button class="btn" onclick="setBudget(event)">Set Budget</button>
                <div class="budget-summary">
                    <div class="budget-item budget"><h3>Budget</h3><div class="amount" id="budgetDisplay">‚Çπ0</div></div>
                    <div class="budget-item spent"><h3>Total Spent</h3><div class="amount" id="totalSpent">‚Çπ0</div></div>
                    <div class="budget-item remaining"><h3>Remaining</h3><div class="amount" id="remaining">‚Çπ0</div></div>
                </div>
            </div>
            <!-- Add Expense Section -->
            <div class="card">
                <h2>‚ûï Add Expense</h2>
                <div class="input-group"><label>Who is adding this expense?</label><div class="radio-group">
                    <div class="radio-option"><input type="radio" id="akshay" name="addedBy" value="Akshay" checked><label for="akshay">Akshay</label></div>
                    <div class="radio-option"><input type="radio" id="achal" name="addedBy" value="Achal"><label for="achal">Achal</label></div>
                </div></div>
                <div class="input-group"><label for="category">Category</label><select id="category">
                    <option>Grocery</option><option>Bills</option><option>Online shopping</option><option>Travelling</option>
                    <option>Food</option><option>Medical expenses</option><option>Debt</option><option>Petrol</option>
                    <option>Home expenses other than grocery</option><option>Maintenance</option><option>EMI</option><option>Investment</option>
                    <option>Entertainment</option><option>Others</option>
                </select></div>
                <div class="input-group"><label for="vendor">Vendor</label><input type="text" id="vendor" placeholder="Enter vendor name"></div>
                <div class="input-group"><label for="amount">Amount (‚Çπ)</label><input type="number" id="amount" placeholder="Enter amount"></div>
                <div class="input-group"><label for="note">Note</label><textarea id="note" rows="3" placeholder="Add a note (optional)"></textarea></div>
                <button class="btn btn-secondary" onclick="addExpense(event)">Add Expense</button>
            </div>
            <!-- Recent Expenses Section -->
            <div class="card full-width">
                <h2>üìã Recent Expenses (Last 5)</h2>
                <div id="recentExpenses"><p style="text-align:center;color:#6b7280;padding:20px;">No expenses added yet</p></div>
            </div>
            <!-- Statistics Section -->
            <div class="stats-grid full-width">
                <div class="card"><h2>üèÜ Top 3 Categories</h2><div class="table-container"><table id="topCategoriesTable"><thead><tr><th>Rank</th><th>Category</th><th>Amount</th><th>%</th></tr></thead><tbody><tr><td colspan="4" style="text-align:center;color:#6b7280;">No data available</td></tr></tbody></table></div></div>
                <div class="card"><h2>üõçÔ∏è Top 3 Vendors</h2><div class="table-container"><table id="topVendorsTable"><thead><tr><th>Rank</th><th>Vendor</th><th>Amount</th><th>%</th></tr></thead><tbody><tr><td colspan="4" style="text-align:center;color:#6b7280;">No data available</td></tr></tbody></table></div></div>
            </div>
            <!-- Summary Sections -->
            <div class="card"><h2>üìä Weekly Summary</h2><div class="table-container"><table id="weeklySummaryTable"><thead><tr><th>Week</th><th>Period</th><th>Total Spent</th></tr></thead><tbody><tr><td colspan="3" style="text-align:center;color:#6b7280;">No data available</td></tr></tbody></table></div></div>
            <div class="card"><h2>üìà Monthly Summary</h2><div class="table-container"><table id="monthlySummaryTable"><thead><tr><th>Month</th><th>Total Spent</th><th>Top Category</th><th>%</th></tr></thead><tbody><tr><td colspan="4" style="text-align:center;color:#6b7280;">No data available</td></tr></tbody></table></div></div>
            <!-- Download Section -->
            <div class="card full-width"><h2>üíæ Export Data</h2><div class="download-buttons"><button class="btn" onclick="downloadCSV()">üìÑ Download CSV</button> <button class="btn" onclick="downloadPDF()">üìä Download PDF</button></div></div>
        </div>
    </div>
    <script>
        let budget = 0;
        let expenses = [];
        function setCurrentMonth() {
            const now = new Date();
            const names = ["January","February","March","April","May","June","July","August","September","October","November","December"];
            document.getElementById('currentMonth').textContent = names[now.getMonth()];
        }
        async function syncToCloud() {
            try {
                localStorage.setItem('shared_budget', budget.toString());
                localStorage.setItem('shared_expenses', JSON.stringify(expenses));
                localStorage.setItem('last_sync', new Date().toISOString());
                showSyncStatus('Data synced successfully!','success');
                return true;
            } catch (e) { showSyncStatus('Sync failed. Data saved locally.','error'); return false; }
        }
        async function syncFromCloud() {
            try {
                const cb=localStorage.getItem('shared_budget'), ce=localStorage.getItem('shared_expenses');
                if(cb&&ce){ budget=parseFloat(cb); expenses=JSON.parse(ce);
                    document.getElementById('budgetAmount').value = budget;
                    updateDisplay();
                    const ls=localStorage.getItem('last_sync'); if(ls){ showSyncStatus(`Last synced: ${new Date(ls).toLocaleString()}`,'success'); }
                }
                return true;
            } catch (e) { showSyncStatus('Failed to load shared data.','error'); return false; }
        }
        function showSyncStatus(msg,type){ const d=document.getElementById('syncStatus'); d.textContent=msg; d.className=`sync-status sync-${type}`; d.style.display='block'; setTimeout(()=>d.style.display='none',3000);}        
        window.onload = function() { setCurrentMonth(); loadData(); syncFromCloud(); updateDisplay(); };
        function loadData(){ const sb=localStorage.getItem('budget'), se=localStorage.getItem('expenses'); if(sb){budget=parseFloat(sb); document.getElementById('budgetAmount').value = budget;} if(se){ expenses=JSON.parse(se);} }
        function saveData(){ localStorage.setItem('budget',budget.toString()); localStorage.setItem('expenses',JSON.stringify(expenses)); syncToCloud(); }
        function setBudget(e){ const inp=document.getElementById('budgetAmount'); const nb=parseFloat(inp.value); if(!nb||nb<=0){ alert('Please enter a valid budget amount'); return;} budget=nb; saveData(); updateDisplay(); const btn=e.target, txt=btn.textContent; btn.textContent='‚úÖ Budget Set!'; btn.style.background='linear-gradient(135deg,#10b981,#059669)'; setTimeout(()=>{btn.textContent=txt; btn.style.background='linear-gradient(135deg,#4f46e5,#7c3aed)';},2000); }
        function addExpense(e){ const cat=document.getElementById('category').value, vend=document.getElementById('vendor').value.trim(), amt=parseFloat(document.getElementById('amount').value), note=document.getElementById('note').value.trim(), by=document.querySelector('input[name="addedBy"]:checked').value; if(!vend){alert('Please enter a vendor name'); return;} if(!amt||amt<=0){alert('Please enter a valid amount'); return;} const now=new Date(); const expense={ id:Date.now(), date:now.toLocaleDateString('en-GB'), time:now.toLocaleTimeString(), category:cat, vendor:vend, amount:amt, note:note, addedBy:by, timestamp:now.getTime() }; expenses.push(expense); saveData(); updateDisplay(); document.getElementById('vendor').value=''; document.getElementById('amount').value=''; document.getElementById('note').value=''; const btn=e.target, txt=btn.textContent; btn.textContent='‚úÖ Added!'; setTimeout(()=>btn.textContent=txt,2000); }
        function deleteExpense(id){ if(confirm('Are you sure you want to delete this expense?')){ expenses=expenses.filter(x=>x.id!==id); saveData(); updateDisplay(); }}
        function updateDisplay(){ updateBudgetSummary(); updateRecentExpenses(); updateTopCategories(); updateTopVendors(); updateWeeklySummary(); updateMonthlySummary(); }
        function updateBudgetSummary(){ const total=expenses.reduce((s,x)=>s+x.amount,0), rem=budget-total; document.getElementById('budgetDisplay').textContent=`‚Çπ${budget.toLocaleString()}`; document.getElementById('totalSpent').textContent=`‚Çπ${total.toLocaleString()}`; document.getElementById('remaining').textContent=`‚Çπ${rem.toLocaleString()}`; }
        function updateRecentExpenses(){ const c=document.getElementById('recentExpenses'); if(!expenses.length){ c.innerHTML='<p style="text-align:center;color:#6b7280;padding:20px;">No expenses added yet</p>'; return;} const recent=expenses.sort((a,b)=>b.timestamp-a.timestamp).slice(0,5); c.innerHTML=recent.map(exp=>`<div class="expense-item"><div class="expense-details"><div class="expense-category">${exp.category}</div><div class="expense-vendor">${exp.vendor} ‚Ä¢ ${exp.date} ${exp.time}</div><div style="font-size:0.8rem;color:#7c3aed;margin-top:2px;">Added by: ${exp.addedBy}</div>${exp.note?`<div style="font-size:0.8rem;color:#6b7280;margin-top:4px;">${exp.note}</div>`:``}</div><div style="display:flex;align-items:center;gap:10px;"><div class="expense-amount">‚Çπ${exp.amount.toLocaleString()}</div><button class="btn btn-danger" onclick="deleteExpense(${exp.id})">üóëÔ∏è</button></div></div>`).join(''); }
        function updateTopCategories(){ const totals=expenses.reduce((a,x)=>{a[x.category]=(a[x.category]||0)+x.amount;return a;},{}) , total=expenses.reduce((s,x)=>s+x.amount,0); const sorted=Object.entries(totals).sort(([,a],[,b])=>b-a).slice(0,3); const tb=document.querySelector('#topCategoriesTable tbody'); if(!sorted.length){ tb.innerHTML='<tr><td colspan="4" style="text-align:center;color:#6b7280;">No data available</td></tr>'; return;} tb.innerHTML=sorted.map(([cat,amt],i)=>`<tr><td>${i+1}</td><td>${cat}</td><td>‚Çπ${amt.toLocaleString()}</td><td>${((amt/total)*100).toFixed(1)}%</td></tr>`).join(''); }
        function updateTopVendors(){ const totals=expenses.reduce((a,x)=>{a[x.vendor]=(a[x.vendor]||0)+x.amount;return a;},{}) , total=expenses.reduce((s,x)=>s+x.amount,0); const sorted=Object.entries(totals).sort(([,a],[,b])=>b-a).slice(0,3); const tb=document.querySelector('#topVendorsTable tbody'); if(!sorted.length){ tb.innerHTML='<tr><td colspan="4" style="text-align:center;color:#6b7280;">No data available</td></tr>'; return;} tb.innerHTML=sorted.map(([vend,amt],i)=>`<tr><td>${i+1}</td><td>${vend}</td><td>‚Çπ${amt.toLocaleString()}</td><td>${((amt/total)*100).toFixed(1)}%</td></tr>`).join(''); }
        function updateWeeklySummary(){ const data={}; expenses.forEach(e=>{ const [d,m,y]=e.date.split('/'); const dt=new Date(y,m-1,d); const ws=new Date(dt); ws.setDate(dt.getDate()-dt.getDay()); const key=ws.toISOString().split('T')[0]; data[key]=(data[key]||0)+e.amount; }); const tb=document.querySelector('#weeklySummaryTable tbody'); const weeks=Object.entries(data).sort(([a],[b])=>new Date(b)-new Date(a)); if(!weeks.length){ tb.innerHTML='<tr><td colspan="3" style="text-align:center;color:#6b7280;">No data available</td></tr>'; return;} tb.innerHTML=weeks.map(([start,total],i)=>{ const s=new Date(start), e=new Date(s); e.setDate(s.getDate()+6); return `<tr><td>Week ${i+1}</td><td>${s.toLocaleDateString('en-GB')} - ${e.toLocaleDateString('en-GB')}</td><td>‚Çπ${total.toLocaleString()}</td></tr>`; }).join(''); }
        function updateMonthlySummary(){ const data={}; expenses.forEach(e=>{ const [d,m,y]=e.date.split('/'); const dt=new Date(y,m-1,d); const key=`${dt.getFullYear()}-${String(dt.getMonth()+1).padStart(2,'0')}`; if(!data[key]) data[key]={ total:0, categories:{} }; data[key].total+=e.amount; data[key].categories[e.category]=(data[key].categories[e.category]||0)+e.amount; }); const tb=document.querySelector('#monthlySummaryTable tbody'); const months=Object.entries(data).sort(([a],[b])=>new Date(b+'-01')-new Date(a+'-01')); if(!months.length){ tb.innerHTML='<tr><td colspan="4" style="text-align:center;color:#6b7280;">No data available</td></tr>'; return;} tb.innerHTML=months.map(([key,val])=>{ const [y,mm]=key.split('-'); const mn=new Date(y,mm-1).toLocaleString('en-GB',{month:'long',year:'numeric'}); const top=Object.entries(val.categories).sort(([,a],[,b])=>b-a)[0]; const pct=((top[1]/val.total)*100).toFixed(1); return `<tr><td>${mn}</td><td>‚Çπ${val.total.toLocaleString()}</td><td>${top[0]}</td><td>${pct}%</td></tr>`; }).join(''); }
        function downloadCSV(){ if(!expenses.length){ alert('No expenses to export'); return;} const hdr=['Date','Time','Category','Vendor','Amount','Note','AddedBy']; const rows=expenses.map(e=>[e.date,e.time,e.category,e.vendor,e.amount,e.note,e.addedBy]); let csv=[hdr.join(',')].concat(rows.map(r=>r.map(f=>`"${(''+f).replace(/"/g,'""')}"`).join(','))).join('\n'); const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=`expenses_${new Date().toISOString().slice(0,10)}.csv`; a.click(); URL.revokeObjectURL(url); }
        function downloadPDF(){ if(!expenses.length){ alert('No expenses to export'); return;} const { jsPDF } = window.jspdf; const doc = new jsPDF(); const cols=['Date','Time','Category','Vendor','Amount','Note','AddedBy']; const rows=expenses.map(e=>[e.date,e.time,e.category,e.vendor,'‚Çπ'+e.amount.toLocaleString(),e.note,e.addedBy]); doc.autoTable({ head:[cols], body:rows, startY:20 }); doc.save(`expenses_${new Date().toISOString().slice(0,10)}.pdf`); }
    </script>
</body>
</html>
